# Chapter 7 Acceptance Testing

## Discussion
Q: 인수 테스트를 작성해보신 경험이 있으신가요? 그리고 그 인수 테스트가 정말로 일이 끝날때를 알려주는 지표?가 되었는지도 궁금합니다.  

A: 저는 솔직히 인수 테스트라는 개념 자체를 몰랐습니다.. 개발 관련 지식에 대한 탐구가 많이 모자라다고 느껴져 조금 부끄러운 점이네요.   

## Review

### Communicating Requirements 
요구 사항은 항상 개발자와 비지니스 사이에 소통 이슈이다. 이러한 요구사항에 대한 소통은 정말 어렵다. 밥 아저씨가 이걸 처음 느꼈던 비개발자 톰과의 일화로 이걸 설명해 준다. 특히 밥 아저씨는 이 경험을 통해 고객이 어떻게 자신이 원하는 걸 알게 되는지 알게 되었다고 한다.  

#### Premature Precision && The Uncertainty Principle && Estimation Anxiety
개발자도 비지니스맨도 항상 시작 단계에 자신들이 원하는 정확한 스펙/요구사항을 가지고 시작하길 원한다. 하지만, 밥 아저씨는 이를 이루는 건 불가하고 시간 낭비가 된다고 말한다.  

고객들은 단순히 종이에 기제되어 있는 정보들을 실제로 구현해 놓고, 고객의 눈앞에 두면 고객은 새로운 시야를 가지고 더 좋은 방안에 대해 생각하게 된다는 이야기이다. 그렇기에 오히려 아주 구체적인 요구사항은 후에 더 고객이 다른 시각을 가지게 되면 쓸모없어져 버린다는 것.  

그렇기에 완벽한 정보로 만든 estimate 이여도 크게 변경될 것이며, 요구사항은 변경될 것이기에 의미가 없다는 이야기.  

일정부분은 동의한다. 회사에서 진행했던 프로젝트도, 개인적으로 진행했던 프로젝트도 결국은 다 첫 기획과는 많이 동떨어져 있던 경우가 많았던 것 같다. 하지만 정말 무조건 불가능한 걸까? 개발을 잘 아는 고객과 고객의 니즈를 잘 아는 개발자가 만난다면 어떨까? 이러한 발상이 정말 꿈 같은 소리라면 괜히 씁쓸해 지는 것 같습니다..  

#### Late Ambiguity
하지만 그렇다고 요구사항에 대한 이해를 끝까지 하지 않는 것은 늦은 모호함을 불러온다. 대부분 요구사항은 완벽히 명확하지 않기 때문에, 표현하는 방법에 따라 의미가 달라지거나 모호한 경우가 있고, 이로인해 고객이 원하는 바를 개발자가 완전히 이해하지 못하는 경우도 발생한다. 이는 면전에서 대화를 하는 경우라 하더라도 발생가능 하는 걸 샘과 폴라의 예시로 설명해 준다.  

개발자든 이해관계자든, 프로라면 모든 모호함 없이 서로가 원하는 내용을 완벽히 전달해야 한다.  

정말 공감가는 부분입니다. 당장 전에 진행했던 프로젝트에서도 정말 중요한 feature 에 대해 고객사 쪽 개발자 분과 저희 피엠님, 그리고 저의 이해도와 중요도가 달랐어서 원하는 방향으로 개발되지 않고 수정해야 하는 일이 있었는데 그 일화가 딱 들어맞는 경우인 것 같습니다.  

#### Acceptance Tests
인수 테스트는 유저들이 릴리즈전에 실행하거나, QA 테스트가 아니다! 이 책에서 밥 아저씨는 이걸 개발자와 이해관계자가 요구 사항이 언제 완료되는지를 정의하는 테스트이다.  

##### the Definition of "DONE"
TDD (정확히 이걸 포함하는 건지는 확실하지 않음. TDD 파인 밥 아저씨기에 이럴거라 생각. 원문은 모든 코드가 작성되었고, 테스트도 모두 통과) -> QA 담당자와 고객이 이를 Accept 함. -> DONE!  

이전에 망했던 폴라와 샘, 톰의 이야기가 원래라면 이랬어야 한다는 예시를 보며 궁금한 내용은 원래 이러한 미팅에 QA 담당자 분도 같이 들어오는 게 보통인가? 이다. 제 경우엔 이런적이 없기 때문에 좀 궁금한 부분입니다.  

##### Communication
인수 테스트의 목적은 소통, 명확함, 정확함이다. 해당 테스트에 내용에 동의하는 것으로 개발자, 고객, 테스터는 시스템의 행동 수칙 계획을 이해했다고 받아드리면 된다는 것 같다. 최소 이정도의 이해를 모든 인원이 가지고 있어야 한다. 프로 개발자라면, 자신만이 아니라 고객과 테스터도 어떤게 만들어지고 어떤게 왜 테스트 되는 지 까지 설명하고 그들이 이해하게 만드는 것도 의무라고 한다.  

##### Automation
**모든 인수 테스트는 항상 자동화 되어야 한다.**  이유는 비용 떄문이다. 밥 아저씨의 예시에서 보여준 수작업 테스트는 말도 안되는 양이기 때문이다.  
그렇기 때문에 프로 개발자라면 인수 테스트의 자동화를 보장해 주어야 한다고 한다. 

#### Extra Work
인수테스트 작성이 추가작업 처럼 보이지만, 자동화 섹션에서 봤듯이, 자동화된 인수테스트가 없는 것이 훨씬 더 많은 작업을 불러온다. 그리고 프로 개발자로서 우리가 언제 진정 작업이 "DONE" 했는 지 알려면 이러한 방식을 채택하는게 맞다.  
이러한 종류의 테스트가 없다면 오히려 더 큰 규모의 QA 세션이 진행되어야만 하고, 이러한 테스트가 있어야지 개발자로서, (고객과 테스터도 포함) 정말로 **끝났을 때를 알 수 있다.**

##### Who writes Acceptance tests, and when?

우리는 고객과 QA 테스터 분들이 이런 테스트들을 함께 짜주고 개발자 꾸준히 그걸 리뷰하고 수정하길 바라지만 그런건 이상적인 세상에서나 가능하다.  
다만 개발자로서 인수테스트를 작성해야 한다면, 인수 테스트를 작성하는 사람과 해당 기능을 작성하는 개발자가 다른 사람이 되도록 해야한다.  
또한 "Late Precision" 원칙에 따라 인수 테스트는 최대한 늦게 작성하는 게 좋다고 한다. 기능이 구현되기 전 한 몇일 전이 밥 아저씨가 생각하는 최적.

에자일에서는 스프린트(Sprint or Iteration)에서 구현할 내용을 미리 선정 후 작성한다고 한다.

왜 늦게 인수 테스트를 작성해야 하는지 앞에 부분은 어느 정도 이해가 간다, 그런데 에자일에 대한 이해가 없어서 그런가 이 부분은 거의 이해를 못한 것 같다.. 이것도 개념적인 부분부터 공부를 해봐야 할 것 같다.

##### The Developer's Role

인수 테스트를 기반으로 코드를 작성하고, 그 기능에 대한 코드가 테스트를 전부 통과하게 만드는 것이 개발자의 역할이라 할 수 있다. 폴라와 피터의 대화를 보면 이 부분도 TDD 방식으로 진행하는 듯 하다. 테스트에
대해 개발 -> 실패 -> 딱 통과할 만큼 개발 -> 무한 반복

##### Test Negotiation and Passive Aggression

테스트 작성자도 휴먼이기 때문에 당연히 실수 할 수 있다. 그렇기에 프로 개발자는 테스트 작성자와 더 좋은 테스트를 위해 협상을 할 의무가 있다. 테스트가 이상하다 느끼면서 테스트가 이러니 맞겠지 하는 생각은 절대
해선 안된다.

개인적으로 예제에 나온 2초안에 되어야 한다~ 와 같은 요구 사항이 많이 있는지 좀 궁금합니다. 그리고 실제로 이러한 경우가 있으셨다면, 예시에선 99.5%의 경우엔 통과하니 고객(이해관계자)가 그걸 수용했는데
어느정도로까지 끌어올려야 이해관계자가 만족할지도 궁금하고 어떻게 테스트를 짜셨는지도 궁금합니다.

##### Acceptance Tests And Unit Tests

인수 테스트 != 유닛 테스트.  
유닛 테스트는 개발자가 개발자(본인 + 타인)를 위해서 작성하는 코드이다. 유닛 테스트는 비지니스를 대상으로 작성하는게 아니라고 한다.  
인수 테스트는 비지니스 파트에서 비지니스를 위해 작성하는 테스트이다 (개발자가 작성하더라도!). 이 테스트들은 비지니스의 관점에서 시스템이 어떻게 동작해야 하는지에 대한 요구사항이다. 다만 이 테스트는 이 상품을
만드는 모든이가 대상이기에 모든이가 제대로 이해하고 있어야 한다.

유닛 테스트든 인수 테스트든 가장 중요한 점은 그들이 가장 중요한 가치는 문서이고 두번째가 테스트라는 점이다. 이들의 목적은 정식으로 디자인과 구조, 그리고 시스템의 작동에 관한 문서 역할을 한다.  
이 테스트들이 우리가 짠 디자인, 구조, 시스템의 동작을 증명하는건 굉장히 유용하다만, 이들의 존재 목적이 그것인 건 아니다.

개인적으론 이러한 내용들이 4장이나 5장에서 미리 다뤘으면 밥 아저씨가 생각하는 TDD에 대해 좀 더 생각해 볼 수 있는 기회가 되었을 것 같다.. 5장에선 잘 짜면 매뉴얼이 될 수 있다 했던 기억이 있는데 여기선
애초에 테스트 코드의 목적은 테스트가 아니야 이러니 이부분을 읽고 5장을 다시 읽어야 했다.

##### GUIs And Other Complications

GUI 도 API를 만드는 것 처럼 설계하고 SRP를 따라 작성하라는 이야기 인 듯 하다.   
뭔가 이론적으로 아 그렇게 할 수도 있겠다는 생각은 들지만, 책을 덮고 내가 혼자 이렇게 테스트를 짜려하면 막막해 진다. 현재 프론트 엔드 생태계에 큰축인 리엑트나 뷰 등에서 사용되는 원칙들을 생각해보면 어떤 생각을
가진건지 알 수 있을 것 같지만서도 그렇게 짜여진 코드도 여전히 테스트 하기 어렵다고 느껴진다..

##### Testing through the Right Interface

GUI에 대한 테스트와 실제 비지니스 규칙들을 나누어 테스트 하라. 그러므로 비지니스 규칙 테스트를 작성할 땐 GUI의 API를 통과하도록 만들어야 한다.  
이 부분도 잘 이해하지 못한 것 같다.. 밥 아저씨가 말하는 GUI란 어디까지 인지도 잘 이해하지 못한건지 GUI의 API를 통과하는 테스트는 사실상 통합 테스트랑 다른게 뭘까 싶기도 하다.

##### Continuous Integration

매 커밋마다 모든 팀원들에게 이메일이 가고 CI가 빌드하여 모든 유닛 테스트와 인수 테스트를 지속적으로 실행하여야 한다.  
CI가 이런 의미에서 정말 도움이 된다고 느껴진다. 처음 CI를 접했을 때는 그냥 서버에 올려주는 작업을 대신 해주는 편리한 기능 정도로만 느꼈는데 이렇게 생각을 해보니 정말 귀중한 기능이구나 싶다.

##### Stop The Presses
CI 테스트가 항상 돌아가도록 해, 만일 테스트가 실패한다면 바로 멈추고 테스트가 다시 통과 될수 있도록 작업을 해야만 한다.  
되게 당연한 말같지만 촉박한 일정이나 여러 이벤트가 겹치면 지키기 정말 어려운 얘기같다. 혹시 이러한 경험이 있으신지도 궁금합니다.

##### Conclusion
디테일에 관한 커뮤니케이션은 힘들다. 밥 아저씨가 생각하는 이러한 커뮤니케이션 오류를 줄이는 유일한 방법은 인수 테스트의 작성이라 한다. 